---
title: è¿™é‡Œæœ‰ECMAScript 2016ï¼Œ2017å’Œ2018 æœ€æ–°ç‰¹æ€§çš„ä¾‹å­
date: 2018-05-25 00:51:51
photos:
tags:
categories:
- Translation
---


**æ–‡ç« å¹¶éé€šç¯‡ç¿»è¯‘ï¼Œè€Œæ˜¯è¿›è¡Œäº†æ‘˜è¦ï¼Œæœ‰å…´è¶£çš„å°ä¼™ä¼´å»ºè®®ç›´æ¥é˜…è¯»åŸæ–‡ï¼Œæœ‰ä»€ä¹ˆå¥½çš„å»ºè®®ï¼Œæˆ–è€…ä¸å¯¹çš„åœ°æ–¹ï¼Œæ¬¢è¿ç•™è¨€æˆ–è€…@æˆ‘**

åŸæ–‡é“¾æ¥ï¼š[https://medium.freecodecamp.org/here-are-examples-of-everything-new-in-ecmascript-2016-2017-and-2018-d52fa3b5a70e](https://medium.freecodecamp.org/here-are-examples-of-everything-new-in-ecmascript-2016-2017-and-2018-d52fa3b5a70e)  

---


ä¸‹æ–‡åŒ…å«äº†18ä¸ª TC39 å·²å®Œæˆææ¡ˆçš„ç‰¹æ€§

<!-- more -->

<!-- TOC -->

- [1. ECMAScript 2016](#1-ecmascript-2016)
  - [1.1. Array.prototype.includes](#11-arrayprototypeincludes)
  - [1.2. å¹‚ä¸­ç¼€è¿ç®—ç¬¦ï¼ˆExponentiation infix operatorï¼‰](#12-å¹‚ä¸­ç¼€è¿ç®—ç¬¦exponentiation-infix-operator)
- [2. ECMAScript 2017](#2-ecmascript-2017)
  - [2.1. Object.values()](#21-objectvalues)
  - [2.2. Object.entries()](#22-objectentries)
  - [2.3. å­—ç¬¦ä¸²å¡«å……ï¼ˆString paddingï¼‰](#23-å­—ç¬¦ä¸²å¡«å……string-padding)
  - [2.4. Object.getOwnPropertyDescriptors](#24-objectgetownpropertydescriptors)
  - [2.5. å‡½æ•°å‚æ•°åé¢åŠ é€—å·ï¼ˆAdd trailing commas in the function parametersï¼‰](#25-å‡½æ•°å‚æ•°åé¢åŠ é€—å·add-trailing-commas-in-the-function-parameters)
  - [2.6. Async/Await](#26-asyncawait)
- [3. ECMAScript 2018](#3-ecmascript-2018)
  - [3.1. å…±äº«å†…å­˜å’Œ atomics ï¼ˆshared memory and atomicsï¼‰](#31-å…±äº«å†…å­˜å’Œ-atomics-shared-memory-and-atomics)
  - [3.2. æ¨¡æ¿å­—ç¬¦ä¸²é™åˆ¶è¢«ç§»é™¤ï¼ˆTagged Template literal restriction removedï¼‰](#32-æ¨¡æ¿å­—ç¬¦ä¸²é™åˆ¶è¢«ç§»é™¤tagged-template-literal-restriction-removed)
  - [3.3. æ­£åˆ™è¡¨è¾¾å¼çš„â€œdotallâ€ç¬¦å·ï¼ˆ"dotall" flag for Regular exporessionï¼‰](#33-æ­£åˆ™è¡¨è¾¾å¼çš„dotallç¬¦å·dotall-flag-for-regular-exporession)
  - [3.4. æ­£åˆ™è¡¨è¾¾å¼çš„å‘½ååˆ†ç»„æ•è·ï¼ˆRegExp Named Group Capturesï¼‰](#34-æ­£åˆ™è¡¨è¾¾å¼çš„å‘½ååˆ†ç»„æ•è·regexp-named-group-captures)
  - [3.5. Rest properties for Objects](#35-rest-properties-for-objects)
  - [3.6. Spread properties for Objects](#36-spread-properties-for-objects)
  - [3.7. æ­£åˆ™è¡¨è¾¾å¼çš„å›æº¯æ–­è¨€ï¼ˆRegExp Lookbehind Assertionsï¼‰](#37-æ­£åˆ™è¡¨è¾¾å¼çš„å›æº¯æ–­è¨€regexp-lookbehind-assertions)
  - [3.8. æ­£åˆ™è¡¨è¾¾å¼çš„ Unicode è½¬ä¹‰å­—ç¬¦ï¼ˆRegExp Unicode Property Escapesï¼‰](#38-æ­£åˆ™è¡¨è¾¾å¼çš„-unicode-è½¬ä¹‰å­—ç¬¦regexp-unicode-property-escapes)
  - [3.9. Promise.prototype.finally()](#39-promiseprototypefinally)
  - [3.10. å¼‚æ­¥è¿­ä»£ï¼ˆAsynchronous Iterationï¼‰](#310-å¼‚æ­¥è¿­ä»£asynchronous-iteration)

<!-- /TOC -->

# 1. ECMAScript 2016

## 1.1. Array.prototype.includes

æ•°ç»„çš„ `includes` æ–¹æ³•å¯ä»¥éå¸¸ç®€å•çš„åˆ¤æ–­è°‹é¡¹æ˜¯å¦å­˜åœ¨äºæ•°ç»„ä¸­ï¼ŒåŒ…æ‹¬ `NaN`

```javascript
const arr = [1, 2, 3, 4, NaN]

// ä½¿ç”¨ indexOf çš„æƒ…å†µ
if (arr.indexOf(3) >= 0) {
    console.log(true)
}

// ä½¿ç”¨ includes
if (arr.includes(3)) {
    console.log(true)
}

// PS: indexOf æ— æ³•æœç´¢ NaN
arr.includes(NaN) // true
arr.indexOf(NaN) // -1
```

## 1.2. å¹‚ä¸­ç¼€è¿ç®—ç¬¦ï¼ˆExponentiation infix operatorï¼‰

ç±»ä¼¼ `++``--`ï¼Œä½¿ç”¨ `**` å¯ä»¥å¿«é€Ÿè¿›è¡Œå¹‚è¿ç®—

```javascript
// ä½¿ç”¨ Math.pow
Math.pow(7, 2) // 49

// ä½¿ç”¨ **
7**2 // 49
```

# 2. ECMAScript 2017

## 2.1. Object.values()

å¯ä»¥ç”¨äºè·å– Object çš„å€¼ï¼Œç±»ä¼¼ `Object.keys()` ç”¨äºè·å– Object ä¸­çš„ key

```javascript
const cars = { BMW: 3, Tesla: 2, Toyota: 1 }

// ä½¿ç”¨ Object.keys() åŠ ä¸Š map çš„æ–¹å¼è·å–å€¼
const vals = Object.keys(cars).map(key => cars[key])

console.log(vals) // [3, 2, 1]

// ä½¿ç”¨ Object.values()
const values = Object.values(cars)

console.log(values) // [3, 2, 1]
```

## 2.2. Object.entries()

å°†å¯¹è±¡çš„ key å’Œ value å˜ä¸ºæ•°ç»„çš„å½¢å¼ï¼Œä¾¿äºå¯¹è±¡çš„éå†æˆ–è€…å°† Object è½¬æ¢ä¸º Map

```javascript

// ä½¿ç”¨æ•ˆæœ
const cars = { BMW: 3, Tesla: 2, Toyota: 1 }

const entries = Object.entries(cars)

console.log(entries) // [ ['BMW', 3], ['Tesla', 2], ['Toyota', 1] ]

// å°† Object è½¬åŒ–ä¸º Map 
const cars = { BMW: 3, Tesla: 2, Toyota: 1 }

const map1 = new Map(Object.entries(cars))
```

[å…³äº Map ç›¸å…³çš„èµ„æ–™ç‚¹å‡»è¿™é‡Œ](https://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000/0014345007434430758e3ac6e1b44b1865178e7aff9082e000)

## 2.3. å­—ç¬¦ä¸²å¡«å……ï¼ˆString paddingï¼‰

å¯ä»¥ä½¿ç”¨ `String.prototype.padStart` å’Œ `String.prototype.padEnd` æ¥å¡«å……å­—ç¬¦ä¸²

```javascript
// å…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°ä»£è¡¨å­—ç¬¦ä¸²çš„æœ€ç»ˆçš„é•¿åº¦ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºéœ€è¦å¡«å……çš„å†…å®¹
// ä»å¤´å¼€å§‹å¡«å……
'5'.padStart(10, '*') // '*********5' 

// ä»å°¾å¼€å§‹å¡«å……
'5'.padEnd(10, '*') // '5*********'
```

## 2.4. Object.getOwnPropertyDescriptors
ç”¨äºè¿”æŸä¸ª Object çš„æ‰€æœ‰ç»†èŠ‚åŒ…æ‹¬ï¼ˆgetï¼Œsetï¼‰  
å¯ä»¥é€šè¿‡ Object çš„æµ…æ‹·è´ï¼ˆObject.assignï¼‰å’Œæ·±æ‹·è´ï¼ˆObject.definePropertiesï¼‰æ¥éªŒè¯

```javascript
var Car = {
    name: 'BMW',
    price: 1000000,
    set discount(x) {
        this.d = x;
    },
    get discount() {
        return this.d;
    }
}

console.log(Object.getOwnPropertyDescriptor(Car, 'discount'));
// { 
//   get: [Function: get],
//   set: [Function: set],
//   enumerable: true,
//   configurable: true
// }

// Object.assign
const ElectricCar = Object.assign({}, Car)
console.log(Object.getOwnPropertyDescriptor(ElectricCar, 'discount'))
// { 
//   value: undefined,
//   writable: true,
//   enumerable: true,
//   configurable: true
// }

// Object.defineProperties
const ElectricCar2 = Object.defineProperties({}, Object.getOwnPropertyDescriptors(Car))
console.log(Object.getOwnPropertyDescriptor(ElectricCar2, 'discount'))
// { get: [Function: get],  ğŸ‘ˆğŸ¼ğŸ‘ˆğŸ¼ğŸ‘ˆğŸ¼
//   set: [Function: set],  ğŸ‘ˆğŸ¼ğŸ‘ˆğŸ¼ğŸ‘ˆğŸ¼
//   enumerable: true,
//   configurable: true 
// }
```

## 2.5. å‡½æ•°å‚æ•°åé¢åŠ é€—å·ï¼ˆAdd trailing commas in the function parametersï¼‰

è¿™æ ·çš„åŸå› æ˜¯ä¸ºäº†ç±»ä¼¼ä½¿ç”¨ git è¿™ç±»çš„å·¥å…·æ—¶ï¼Œåªæœ‰æ–°å¢çš„è¡Œå‘ç”Ÿå˜åŒ–ï¼ˆå¯èƒ½å’Œä»£ç é£æ ¼æœ‰å…³ï¼‰

## 2.6. Async/Await

è¿™ä¸ªåº”è¯¥éƒ½æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼Œç›´æ¥ä¸Šä¾‹å­

```javascript
function getUser() {
    return new Promise(resolve => {
        setTimeout(() => {
            resolve('join')
        }, 1000)
    })
}

function getBankBalance() {
    return new Promise(resolve => {
        setTimeout(() => {
            resolve('$1,000')
        }, 2000)
    })
}

// ä½¿ç”¨ async/await ä¹‹å‰
function getAmount() {
    getUser()
        .then(getBankBalance)
        .then(amount => {
            console.log(amount)
        })
}

// ä½¿ç”¨ async/await ä¹‹å
async function getAmount2() {
    var user = await getUser()
    var amount = await getBankBalnce(user);
    console.log(amount)
}

```

* Async å‡½æ•°è‡ªèº«è¿”å›çš„æ˜¯ä¸€ä¸ª `Promise` æ‰€ä»¥å¯ä»¥ä½¿ç”¨ `.then` æ–¹æ³•
* async/await å¹¶è¡Œä½¿ç”¨ `Promise.all`
    ```javascript
    function doulieAfterSec() {
        return new Promise(resolve => {
            setTimeout(resolve(2), 1000)
        })
    }
    
    async function doubleAdded() {
        [a, b] = await Promise.all(doulieAfterSec(), doulieAfterSec())
    }
    ```

# 3. ECMAScript 2018

## 3.1. å…±äº«å†…å­˜å’Œ atomics ï¼ˆshared memory and atomicsï¼‰

ä¸€ä¸ªæ¯”è¾ƒé«˜çº§çš„ç‰¹æ€§ï¼Œè¿˜æ˜¯è‡ªè¡ŒæŸ¥çœ‹ä½œè€…ç»™å‡ºçš„æ–‡ç« å§

* [From Workers to Shared Memoryâ€Šâ€”â€Šlucasfcosta](http://lucasfcosta.com/2017/04/30/JavaScript-From-Workers-to-Shared-Memory.html)
* [A cartoon intro to SharedArrayBuffersâ€Šâ€”â€ŠLin Clark](https://medium.com/@linclark)
* [Shared memory and atomicsâ€Šâ€”â€ŠDr. Axel Rauschmayer](http://2ality.com/2017/01/shared-array-buffer.html)


## 3.2. æ¨¡æ¿å­—ç¬¦ä¸²é™åˆ¶è¢«ç§»é™¤ï¼ˆTagged Template literal restriction removedï¼‰

åœ¨ ES2016 å’Œ ES2016 è§„èŒƒä¸­ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²ä¸å…è®¸ä½¿ç”¨çš„è½¬ä¹‰å­—ç¬¦ï¼Œç±»ä¼¼`\u`,`\x`  

ä½†æ˜¯åœ¨ ES2018ï¼Œæ”¾å®½äº†è¿™ä¸ªè¦æ±‚ï¼Œå…è®¸å‡ºç°è¿™äº›å­—ç¬¦ä¸²ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ä¸ª Objectï¼Œé‡Œé¢æœ‰ `cooked` è¿™ä¸ªå±æ€§ï¼ˆä¹Ÿå¯ä»¥æ˜¯ä»»æ„ä¸€ä¸ªå±æ€§ï¼‰ï¼Œæ¥è¡¨ç¤º "undefined"ï¼Œç„¶åå†å®šä¹‰ä¸€ä¸ª `raw` å±æ€§ï¼ˆä¹Ÿå¯ä»¥æ˜¯ä»»æ„ä½ æƒ³è¦çš„åå­—ï¼‰ï¼Œå°†è¿™äº› `\u`,`\x` å­—ç¬¦å­˜å‚¨åœ¨ `raw` ä¸­

```javascript
function myTagFunc(str) { 
    console.log(str) // [undefined, raw: [['hi \ubla123abla']]]
    return { "cooked": "undefined", "raw": str.raw[0] }
} 

var str = myTagFunc `hi \ubla123abla`

str // { cooked: "undefined", raw: "hi \ubla123abla" }
```


## 3.3. æ­£åˆ™è¡¨è¾¾å¼çš„â€œdotallâ€ç¬¦å·ï¼ˆ"dotall" flag for Regular exporessionï¼‰

åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­,`.`ç¬¦å·å…è®¸åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œä½†æ˜¯ä¸åŒ¹é…æ¢è¡Œå­—ç¬¦ï¼Œç±»ä¼¼ `\n``\r``\f`ç­‰  
ä½†æ˜¯åœ¨ ES2018 ä¸­ï¼Œå¢åŠ äº† `/first.second/s` ä¸­çš„ `/s` æ ‡å¿—ä½æ¥è¡¨ç¤º`.`æ¥æ”¯æŒåŒ¹é…æ¢è¡Œå­—ç¬¦

```javascript
// åœ¨ä¸æ”¯æŒä¹‹å‰
/first.second/.test('first\nsecond'); //false

// åœ¨ ES2018 ä¸­
/first.second/s.test('first\nsecond'); //true
```

## 3.4. æ­£åˆ™è¡¨è¾¾å¼çš„å‘½ååˆ†ç»„æ•è·ï¼ˆRegExp Named Group Capturesï¼‰

æä¾›äº†ç±»ä¼¼ Pythonã€Java ç­‰è¯­è¨€ä¸­çš„å‘½ååˆ†ç»„ï¼ˆå½“å¹´ç”¨ Python å†™çˆ¬è™«çš„æ—¶å€™ç›¸å½“å¥½ç”¨ï¼‰ï¼Œè¯­æ³•æ ¼å¼ä¸º `(?<name>...)`  

```javascript
// åŸå…ˆçš„å‘½ååˆ†ç»„
let re1 = /(\d{4})-(\d{2})-(\d{2})/
let result1 = re1.exec('2015-01-02')
console.log(result1) // ['2015-01-02', '2015', '01', '02', index: 0, input: '2015-01-02', groups: undefined]

// ä½¿ç”¨å‘½ååˆ†ç»„å
let re2 = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/
let result2 = re2.exec('2015-01-02')
console.log(result2) // ['2015-01-02', '2015', '01', '02', index: 0, input: '2015-01-02', groups: { year: '2015',  month: '01', day: '02'}]
console.log(result2.groups.year) // 2015
```

å¯ä»¥ä½¿ç”¨ `\k<group name>` åœ¨åŒä¸€ä¸ªè¡¨è¾¾å¼ä¸­è¡¨ç¤ºç›¸åŒåˆ†ç»„
```javascript
let sameWords = /(?<fruit>apple|orange)==\k<fruit>/u;

sameWords.test('apple==apple') // true
sameWords.test('apple==orange') // false
```

å­—ç¬¦ä¸²ä¸­çš„å‘½ååˆ†ç»„ä½¿ç”¨
```javascript
// å°† "firstName lastName" æ›¿æ¢ä¸º "lastName, firstName"
let re = /(?<firstName>[A-Za-z]+) (?<lastName>[A-Za-z]+$)/u

'Raja Rao'.replace(re, '$<lastName>, $<firstName>') // "Rao, Raja"
```

## 3.5. Rest properties for Objects

ä½¿ç”¨ `...` æ“ä½œç¬¦å¯ä»¥å°† Object çš„å‰©ä½™æœªæŒ‡å®šçš„å±æ€§è¿›è¡Œèµ‹å€¼

```javascript
let { firstName, age, ...remaining } = {
    firstName: 'john',
    lasttName: 'smith',
    age: 20,
    height: '5.10',
    race: 'martian'
}

firstName // john
age // 20

remaining // { lasttName: 'smith', age: 20, height: '5.10', race: 'martian' }
```
å¯ä»¥ç”¨æ¥ç§»é™¤ä¸æƒ³è¦çš„é¡¹

```javascript
let { firstName, age, ...cleanObj } = {
    firstName: 'john',
    lasttName: 'smith',
    age: 20,
    height: '5.10',
    race: 'martian'
}

// cleanObj å°±æ˜¯ä½ çœŸæ­£æƒ³è¦çš„å±æ€§
cleanObj // { lasttName: 'smith', age: 20, height: '5.10', race: 'martian' }
```

## 3.6. Spread properties for Objects

`...` ä¹Ÿå¯ç”¨äºåˆå¹¶æ—§å¯¹è±¡åˆ›å»ºæ–°å¯¹è±¡

```javascript
const person = { fName: 'john' }
const account = { amount: '$1000' }

const personAndAccount = { ...person, ...account }

personAndAccount // { fName: 'john', amount: '$1000' }
```

## 3.7. æ­£åˆ™è¡¨è¾¾å¼çš„å›æº¯æ–­è¨€ï¼ˆRegExp Lookbehind Assertionsï¼‰

å¯ä»¥`(?<=...)`è·å–ä»¥æŸä¸ªç‰¹å®šæ ‡è¯†ä¹‹åçš„å†…å®¹ï¼Œ`(?<!...)`è·å–éæŸä¸ªç‰¹å®šæ ‡è¯†ä¹‹åçš„å†…å®¹

```javascript

'#winning'.match(/(?<=#).*/)[0] // 'winning'

'A gallon of milk is $3.00'.match(/(?<!\$).*/) // null

```

## 3.8. æ­£åˆ™è¡¨è¾¾å¼çš„ Unicode è½¬ä¹‰å­—ç¬¦ï¼ˆRegExp Unicode Property Escapesï¼‰

å¦‚é¢˜ï¼Œæ›´å¤šå†…å®¹å¯ä»¥[ç‚¹å‡»æŸ¥çœ‹](https://mathiasbynens.be/notes/es-unicode-property-escapes)

```javascript
//The following matches multiple hindi character
/^\p{Script=Devanagari}+$/u.test('à¤¹à¤¿à¤¨à¥à¤¦à¥€'); //true  
//PS:there are 3 hindi characters h

//The following matches a single Greek character
/\p{Script_Extensions=Greek}/u.test('Ï€'); // true
```

## 3.9. Promise.prototype.finally()

Promise å¢åŠ äº†ä¸€ä¸ª `finally()` æ–¹æ³•ï¼Œé¡¾åæ€ä¹‰ï¼Œä¸ç®¡æ˜¯ reslove è¿˜æ˜¯ rejectï¼Œæœ€ç»ˆéƒ½ä¼šæ‰§è¡Œ

```javascript
let myPromise = new Promise((resolve, reject) => {
    throw new Error('wrong')
})
.then(val => {
    console.log(val)
})
.catch(e => {
    throw new Error('wrong')
})
.finally(() => {
    console.log('è¿™é‡Œå§‹ç»ˆä¼šè¢«æ‰§è¡Œ')
})
```

## 3.10. å¼‚æ­¥è¿­ä»£ï¼ˆAsynchronous Iterationï¼‰

é¡¾åæ€ä¹‰ï¼Œä¸€ä¸ªæ”¯æŒåŒ…å«å¼‚æ­¥çš„è¿­ä»£ `for-await-of`

```javascript
const promises = [
    new Promise(resolve => resolve(1)),
    new Promise(resolve => resolve(2)),
    new Promise(resolve => resolve(3))
]

// ä¸æ”¯æŒçš„æƒ…å†µ
async function test1() {
    for (const obj of promises) {
        console.log(obj) // æ˜¾ç¤º 3 ä¸ª Promise å¯¹è±¡
    }
}

// ä½¿ç”¨ for-await-of
async function test2() {
    for await(const obj of promises) {
        console.log(obj) // æ˜¾ç¤º 1,2,3
    }
}

test1() // Promise, Promise, Promise
test2()// 1, 2, 3 ...
```


---

åŸæ–‡é“¾æ¥ï¼š[https://medium.freecodecamp.org/here-are-examples-of-everything-new-in-ecmascript-2016-2017-and-2018-d52fa3b5a70e](https://medium.freecodecamp.org/here-are-examples-of-everything-new-in-ecmascript-2016-2017-and-2018-d52fa3b5a70e)  
